CREATE OR REPLACE TABLE {catalog_name}.gold_tp.tp_custm_fct (
  secure_group_key BIGINT NOT NULL,
  run_id BIGINT NOT NULL,
  srce_sys_id SMALLINT NOT NULL,
  cntrt_id BIGINT NOT NULL,
  mm_time_perd_end_date DATE NOT NULL,
  mkt_skid BIGINT NOT NULL,
  prod_skid BIGINT NOT NULL,
  time_perd_id BIGINT NOT NULL,
  extrn_time_perd_desc STRING,
  first_wk_sellg DATE,
  iso_crncy_code VARCHAR(15),
  exchg_rate_usd_amt DECIMAL(38,10),
  exchg_rate_cus_amt DECIMAL(38,10),
  exchg_rate_eur_amt DECIMAL(38,10),
  sales_mlc_amt DECIMAL(38,10),
  sales_mlc_any_prmtn_amt DECIMAL(38,10),
  sales_mlc_bnspk_amt DECIMAL(38,10),
  sales_mlc_dsply_amt DECIMAL(38,10),
  sales_mlc_dsply_wo_featr_amt DECIMAL(38,10),
  sales_mlc_featr_amt DECIMAL(38,10),
  sales_mlc_featr_dsply_amt DECIMAL(38,10),
  sales_mlc_featr_wo_dsply_amt DECIMAL(38,10),
  sales_mlc_hybrd_amt DECIMAL(38,10),
  sales_mlc_non_prmtn_amt DECIMAL(38,10),
  sales_mlc_nrmlz_amt DECIMAL(38,10),
  sales_mlc_prcut_amt DECIMAL(38,10),
  sales_mlc_prcut_only_amt DECIMAL(38,10),
  sales_musd_amt DECIMAL(38,10),
  sales_musd_any_prmtn_amt DECIMAL(38,10),
  sales_musd_dsply_amt DECIMAL(38,10),
  sales_musd_dsply_wo_featr_amt DECIMAL(38,10),
  sales_musd_featr_amt DECIMAL(38,10),
  sales_musd_featr_dsply_amt DECIMAL(38,10),
  sales_musd_featr_wo_dsply_amt DECIMAL(38,10),
  sales_musd_non_prmtn_amt DECIMAL(38,10),
  sales_musd_prcut_amt DECIMAL(38,10),
  sales_musd_prcut_only_amt DECIMAL(38,10),
  sales_mcus_amt DECIMAL(38,10),
  sales_mcus_any_prmtn_amt DECIMAL(38,10),
  sales_mcus_dsply_amt DECIMAL(38,10),
  sales_mcus_dsply_wo_featr_amt DECIMAL(38,10),
  sales_mcus_featr_amt DECIMAL(38,10),
  sales_mcus_featr_wo_dsply_amt DECIMAL(38,10),
  sales_mcus_non_prmtn_amt DECIMAL(38,10),
  sales_mcus_prcut_amt DECIMAL(38,10),
  sales_mcus_prcut_only_amt DECIMAL(38,10),
  sales_meur_amt DECIMAL(38,10),
  sales_meur_non_prmtn_amt DECIMAL(38,10),
  sales_cnprc_mlc_amt DECIMAL(38,10),
  sales_cnprc_mlc_any_prmtn_amt DECIMAL(38,10),
  sales_cnprc_mlc_efeat_amt DECIMAL(38,10),
  sales_cnprc_musd_amt DECIMAL(38,10),
  sales_cnprc_musd_any_prmtn_amt DECIMAL(38,10),
  sales_efprc_mlc_efeat_amt DECIMAL(38,10),
  sales_msu_qty DECIMAL(38,10),
  sales_msu_any_prmtn_qty DECIMAL(38,10),
  sales_msu_bnspk_qty DECIMAL(38,10),
  sales_msu_dsply_qty DECIMAL(38,10),
  sales_msu_dsply_wo_featr_qty DECIMAL(38,10),
  sales_msu_efeat_qty DECIMAL(38,10),
  sales_msu_featr_dsply_qty DECIMAL(38,10),
  sales_msu_featr_qty DECIMAL(38,10),
  sales_msu_featr_wo_dsply_qty DECIMAL(38,10),
  sales_msu_non_prmtn_qty DECIMAL(38,10),
  sales_msu_nrmlz_qty DECIMAL(38,10),
  sales_msu_prcut_10_20_qty DECIMAL(38,10),
  sales_msu_prcut_20_30_qty DECIMAL(38,10),
  sales_msu_prcut_30_40_qty DECIMAL(38,10),
  sales_msu_prcut_40_more_qty DECIMAL(38,10),
  sales_msu_prcut_only_qty DECIMAL(38,10),
  sales_msu_prcut_qty DECIMAL(38,10),
  sales_mu_qty DECIMAL(38,10),
  sales_mu_any_prmtn_qty DECIMAL(38,10),
  sales_mu_dsply_qty DECIMAL(38,10),
  sales_mu_dsply_wo_featr_qty DECIMAL(38,10),
  sales_mu_featr_dsply_qty DECIMAL(38,10),
  sales_mu_featr_qty DECIMAL(38,10),
  sales_mu_featr_wo_dsply_qty DECIMAL(38,10),
  sales_mu_non_prmtn_qty DECIMAL(38,10),
  sales_mu_nrmlz_qty DECIMAL(38,10),
  sales_mu_prcut_only_qty DECIMAL(38,10),
  sales_mu_prcut_qty DECIMAL(38,10),
  sales_mpu_qty DECIMAL(38,10),
  sales_mpu_any_prmtn_qty DECIMAL(38,10),
  sales_mpu_non_prmtn_qty DECIMAL(38,10),
  sales_mpu_prcut_qty DECIMAL(38,10),
  sales_per_dspt_mcus_amt DECIMAL(38,10),
  sales_per_dspt_meur_amt DECIMAL(38,10),
  sales_per_dspt_mlc_amt DECIMAL(38,10),
  sales_per_dspt_msu_qty DECIMAL(38,10),
  sales_per_dspt_mu_qty DECIMAL(38,10),
  sales_per_dspt_musd_amt DECIMAL(38,10),
  sales_per_lngth_mcus_amt DECIMAL(38,10),
  sales_per_lngth_meur_amt DECIMAL(38,10),
  sales_per_lngth_mlc_amt DECIMAL(38,10),
  sales_per_lngth_msu_qty DECIMAL(38,10),
  sales_per_lngth_musd_amt DECIMAL(38,10),
  sales_per_tdp_lc_amt DECIMAL(38,10),
  sales_per_tdp_lc_amt_ya DECIMAL(38,10),
  acct_share_lc_any_prmtn_pct DECIMAL(38,10),
  acct_share_lc_pct DECIMAL(38,10),
  acct_share_su_any_prmtn_pct DECIMAL(38,10),
  acct_share_su_pct DECIMAL(38,10),
  acct_share_u_any_prmtn_pct DECIMAL(38,10),
  acct_share_u_pct DECIMAL(38,10),
  acv_any_prmtn_pct DECIMAL(38,10),
  acv_any_prmtn_pct_ya DECIMAL(38,10),
  acv_dsply_pct DECIMAL(38,10),
  acv_dsply_pct_ya DECIMAL(38,10),
  acv_featr_pct DECIMAL(38,10),
  acv_featr_pct_ya DECIMAL(38,10),
  acv_non_prmtn_pct DECIMAL(38,10),
  acv_non_prmtn_pct_ya DECIMAL(38,10),
  acv_pct DECIMAL(38,10),
  acv_pct_ya DECIMAL(38,10),
  acv_prcut_only_pct DECIMAL(38,10),
  acv_prcut_only_pct_ya DECIMAL(38,10),
  acv_reach_any_prmtn_pct DECIMAL(38,10),
  acv_reach_any_prmtn_pct_ya DECIMAL(38,10),
  acv_reach_dsply_pct DECIMAL(38,10),
  acv_reach_dsply_pct_ya DECIMAL(38,10),
  acv_reach_dsply_wo_featr_pct DECIMAL(38,10),
  acv_reach_dsply_wo_featr_pct_ya DECIMAL(38,10),
  acv_reach_featr_dsply_pct DECIMAL(38,10),
  acv_reach_featr_dsply_pct_ya DECIMAL(38,10),
  acv_reach_featr_or_dsply_pct DECIMAL(38,10),
  acv_reach_featr_or_dsply_pct_ya DECIMAL(38,10),
  acv_reach_featr_pct DECIMAL(38,10),
  acv_reach_featr_pct_ya DECIMAL(38,10),
  acv_reach_featr_wo_dsply_pct DECIMAL(38,10),
  acv_reach_featr_wo_dsply_pct_ya DECIMAL(38,10),
  acv_reach_pct DECIMAL(38,10),
  acv_reach_pct_ya DECIMAL(38,10),
  acv_reach_prcut_only_pct DECIMAL(38,10),
  acv_reach_prcut_only_pct_ya DECIMAL(38,10),
  basln_mcus_amt DECIMAL(38,10),
  basln_mcus_any_prmtn_amt DECIMAL(38,10),
  basln_mlc_amt DECIMAL(38,10),
  basln_mlc_any_prmtn_amt DECIMAL(38,10),
  basln_mlc_non_prmtn_amt DECIMAL(38,10),
  basln_mpu_any_prmtn_qty DECIMAL(38,10),
  basln_mpu_non_prmtn_qty DECIMAL(38,10),
  basln_mpu_qty DECIMAL(38,10),
  basln_msu_any_prmtn_qty DECIMAL(38,10),
  basln_msu_dsply_qty DECIMAL(38,10),
  basln_msu_featr_dsply_qty DECIMAL(38,10),
  basln_msu_featr_qty DECIMAL(38,10),
  basln_msu_non_prmtn_qty DECIMAL(38,10),
  basln_msu_prcut_only_qty DECIMAL(38,10),
  basln_msu_prcut_qty DECIMAL(38,10),
  basln_msu_qty DECIMAL(38,10),
  basln_mu_any_prmtn_qty DECIMAL(38,10),
  basln_mu_non_prmtn_qty DECIMAL(38,10),
  basln_mu_qty DECIMAL(38,10),
  basln_musd_amt DECIMAL(38,10),
  basln_musd_any_prmtn_amt DECIMAL(38,10),
  basln_per_tdp_lc_am_ya DECIMAL(38,10),
  basln_per_tdp_lc_amt DECIMAL(38,10),
  categ_share_hndlg_u_pct DECIMAL(38,10),
  categ_share_lc_any_prmtn_pct DECIMAL(38,10),
  categ_share_lc_pct DECIMAL(38,10),
  categ_share_of_sku_su_pct DECIMAL(38,10),
  categ_share_of_sku_u_pct DECIMAL(38,10),
  categ_share_su_pct DECIMAL(38,10),
  categ_share_u_pct DECIMAL(38,10),
  disc_depth_dsply_pct DECIMAL(38,10),
  disc_depth_pct DECIMAL(38,10),
  dist_effcy_u_qty DECIMAL(38,10),
  dsply_u_qty_ya DECIMAL(38,10),
  frwrd_stock_msu_qty DECIMAL(38,10),
  frwrd_stock_mu_qty DECIMAL(38,10),
  frwrd_stock_per_dspt_msu_qty DECIMAL(38,10),
  incrm_mlc_amt DECIMAL(38,10),
  incrm_mlc_amt_ya DECIMAL(38,10),
  incrm_mlc_any_prmtn_amt DECIMAL(38,10),
  incrm_mlc_any_prmtn_amt_ya DECIMAL(38,10),
  num_avg_itm_any_prmtn_u_qty DECIMAL(38,10),
  num_avg_itm_any_prmtn_u_qty_ya DECIMAL(38,10),
  num_avg_itm_dsply_u_qty DECIMAL(38,10),
  num_avg_itm_dsply_u_qty_ya DECIMAL(38,10),
  num_avg_itm_featr_u_qty DECIMAL(38,10),
  num_avg_itm_featr_u_qty_ya DECIMAL(38,10),
  num_avg_itm_non_prmtn_u_qty DECIMAL(38,10),
  num_avg_itm_non_prmtn_u_qty_ya DECIMAL(38,10),
  num_avg_itm_prcut_only_u_qty DECIMAL(38,10),
  num_avg_itm_prcut_only_u_qty_ya DECIMAL(38,10),
  num_avg_itm_u_qty DECIMAL(38,10),
  num_avg_itm_u_qty_ya DECIMAL(38,10),
  num_sku_u_qty DECIMAL(38,10),
  num_store_unvrs_sellg_u_qty DECIMAL(38,10),
  num_store_unvrs_sellg_u_qty_ya DECIMAL(38,10),
  num_store_unvrs_u_qty DECIMAL(38,10),
  num_store_unvrs_u_qty_ya DECIMAL(38,10),
  numrc_dist_any_prmtn_pct DECIMAL(38,10),
  numrc_dist_dsply_pct DECIMAL(38,10),
  numrc_dist_dsply_wo_featr_pct DECIMAL(38,10),
  numrc_dist_featr_dsply_pct DECIMAL(38,10),
  numrc_dist_featr_pct DECIMAL(38,10),
  numrc_dist_featr_wo_dsply_pct DECIMAL(38,10),
  numrc_dist_hndlg_pct DECIMAL(38,10),
  numrc_dist_oos_hndlg_pct DECIMAL(38,10),
  numrc_dist_oos_pct DECIMAL(38,10),
  numrc_dist_other_pct DECIMAL(38,10),
  numrc_dist_pct DECIMAL(38,10),
  numrc_dist_prcut_only_pct DECIMAL(38,10),
  numrc_dist_purch_pct DECIMAL(38,10),
  numrc_dist_sellg_3_mth_pct DECIMAL(38,10),
  numrc_dist_sellg_4_wk_pct DECIMAL(38,10),
  numrc_dist_sellg_6_mth_pct DECIMAL(38,10),
  numrc_dist_sellg_pct DECIMAL(38,10),
  numrc_dist_stock_pct DECIMAL(38,10),
  price_per_p_cus_amt DECIMAL(38,10),
  price_per_p_cus_any_prmtn_amt DECIMAL(38,10),
  price_per_p_lc_amt DECIMAL(38,10),
  price_per_p_lc_any_prmtn_amt DECIMAL(38,10),
  price_per_p_usd_amt DECIMAL(38,10),
  price_per_p_usd_any_prmtn_amt DECIMAL(38,10),
  price_per_su_cus_amt DECIMAL(38,10),
  price_per_su_cus_any_prmtn_amt DECIMAL(38,10),
  price_per_su_eur_amt DECIMAL(38,10),
  price_per_su_lc_amt DECIMAL(38,10),
  price_per_su_lc_any_prmtn_amt DECIMAL(38,10),
  price_per_su_lc_non_prmtn_amt DECIMAL(38,10),
  price_per_su_usd_amt DECIMAL(38,10),
  price_per_su_usd_any_prmtn_amt DECIMAL(38,10),
  price_per_u_cus_amt DECIMAL(38,10),
  price_per_u_cus_any_prmtn_amt DECIMAL(38,10),
  price_per_u_cus_non_prmtn_amt DECIMAL(38,10),
  price_per_u_eur_amt DECIMAL(38,10),
  price_per_u_lc_amt DECIMAL(38,10),
  price_per_u_lc_any_prmtn_amt DECIMAL(38,10),
  price_per_u_lc_non_prmtn_amt DECIMAL(38,10),
  price_per_u_usd_amt DECIMAL(38,10),
  price_per_u_usd_any_prmtn_amt DECIMAL(38,10),
  price_per_u_usd_non_prmtn_amt DECIMAL(38,10),
  prmtn_itsty_mlc_pct DECIMAL(38,10),
  prmtn_itsty_su_pct DECIMAL(38,10),
  purch_mlc_amt DECIMAL(38,10),
  purch_msu_qty DECIMAL(38,10),
  purch_mu_qty DECIMAL(38,10),
  rsrv_stock_msu_qty DECIMAL(38,10),
  rsrv_stock_mu_qty DECIMAL(38,10),
  shelf_lngth_qty DECIMAL(38,10),
  shelf_sellg_lngth_qty DECIMAL(38,10),
  sku_per_dspt_u_qty DECIMAL(38,10),
  stock_msu_qty DECIMAL(38,10),
  stock_mu_qty DECIMAL(38,10),
  stock_per_dspt_msu_qty DECIMAL(38,10),
  tdp_sellg_4_wk_u_qty DECIMAL(38,10),
  tdp_u_any_prmtn_qty DECIMAL(38,10),
  tdp_u_dsply_qty DECIMAL(38,10),
  tdp_u_dsply_wo_featr_qty DECIMAL(38,10),
  tdp_u_featr_dsply_qty DECIMAL(38,10),
  tdp_u_featr_qty DECIMAL(38,10),
  tdp_u_featr_wo_dsply_qty DECIMAL(38,10),
  tdp_u_free_qty DECIMAL(38,10),
  tdp_u_non_prmtn_qty DECIMAL(38,10),
  tdp_u_prcut_only_qty DECIMAL(38,10),
  tdp_u_prcut_qty DECIMAL(38,10),
  tdp_u_qlty_qty DECIMAL(38,10),
  tdp_u_qty DECIMAL(38,10),
  tdp_u_reach_qty DECIMAL(38,10),
  tdp_u_reach_qty_ya DECIMAL(38,10),
  wgt_dist_any_prmtn_pct DECIMAL(38,10),
  wgt_dist_bnspk_pct DECIMAL(38,10),
  wgt_dist_comm_std_pack_pct DECIMAL(38,10),
  wgt_dist_comm_store_pct DECIMAL(38,10),
  wgt_dist_coupn_pct DECIMAL(38,10),
  wgt_dist_dsply_pct DECIMAL(38,10),
  wgt_dist_dsply_prcut_pct DECIMAL(38,10),
  wgt_dist_dsply_wo_featr_pct DECIMAL(38,10),
  wgt_dist_featr_dsply_pct DECIMAL(38,10),
  wgt_dist_featr_pct DECIMAL(38,10),
  wgt_dist_featr_prcut_pct DECIMAL(38,10),
  wgt_dist_featr_wo_dsply_pct DECIMAL(38,10),
  wgt_dist_gift_pct DECIMAL(38,10),
  wgt_dist_hndlg_pct DECIMAL(38,10),
  wgt_dist_oos_pct DECIMAL(38,10),
  wgt_dist_other_pct DECIMAL(38,10),
  wgt_dist_pct DECIMAL(38,10),
  wgt_dist_prcut_10_20_pct DECIMAL(38,10),
  wgt_dist_prcut_20_30_pct DECIMAL(38,10),
  wgt_dist_prcut_30_40_pct DECIMAL(38,10),
  wgt_dist_prcut_40_more_pct DECIMAL(38,10),
  wgt_dist_prcut_only_pct DECIMAL(38,10),
  wgt_dist_prcut_pct DECIMAL(38,10),
  wgt_dist_purch_pct DECIMAL(38,10),
  wgt_dist_sellg_3_mth_pct DECIMAL(38,10),
  wgt_dist_sellg_4_wk_pct DECIMAL(38,10),
  wgt_dist_sellg_6_mth_pct DECIMAL(38,10),
  wgt_dist_sellg_lc_pct DECIMAL(38,10),
  wgt_dist_sellg_pct DECIMAL(38,10),
  wgt_dist_sellg_su_pct DECIMAL(38,10),
  wgt_dist_stock_pct DECIMAL(38,10),
  wgt_invst_prcut_pct DECIMAL(38,10),
  wgt_num_sku_u_qty DECIMAL(38,10),
  wgt_prcut_durtn_wk_cnt DECIMAL(38,10),
  part_srce_sys_id SMALLINT,
  part_cntrt_id BIGINT,
  part_mm_time_perd_end_date DATE)
USING delta
PARTITIONED BY (part_srce_sys_id, part_cntrt_id, part_mm_time_perd_end_date)
LOCATION 'abfss://tp-publish-data@{storage_name}.dfs.core.windows.net/TP_CUSTM_FCT'
WITH ROW FILTER `{catalog_name}`.`gold_tp`.`das_rls` ON (secure_group_key)
TBLPROPERTIES (
  'delta.enableDeletionVectors' = 'true',
  'delta.feature.deletionVectors' = 'supported',
  'delta.feature.invariants' = 'supported',
  'delta.minReaderVersion' = '3',
  'delta.minWriterVersion' = '7')
